{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/utils/id.ts"],"sourcesContent":["export function generateId(): string {\r\n  // Generate a timestamp-based ID with a random component\r\n  const timestamp = Date.now().toString(36);\r\n  const randomStr = Math.random().toString(36).substring(2, 8);\r\n  return `${timestamp}-${randomStr}`;\r\n}\r\n"],"names":[],"mappings":";;;AAAO,SAAS;IACd,wDAAwD;IACxD,MAAM,YAAY,KAAK,GAAG,GAAG,QAAQ,CAAC;IACtC,MAAM,YAAY,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG;IAC1D,OAAO,GAAG,UAAU,CAAC,EAAE,WAAW;AACpC"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/storage/db.ts"],"sourcesContent":["import { Conversation, Message, ModelContext } from './types';\r\nimport { generateId } from '../utils/id';\r\n\r\nexport class StorageManager {\r\n  private dbName = 'chatApp';\r\n  private version = 1;\r\n\r\n  // We use a class to manage database operations because it helps us keep\r\n  // all database logic in one place and maintain a consistent connection\r\n  async initDB(): Promise<IDBDatabase> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(this.dbName, this.version);\r\n\r\n      // This creates our database structure when it's first opened\r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result;\r\n        \r\n        // Store for overall conversation metadata\r\n        if (!db.objectStoreNames.contains('conversations')) {\r\n          const conversationStore = db.createObjectStore('conversations', { keyPath: 'id' });\r\n          // Create indexes to help us search and sort conversations\r\n          conversationStore.createIndex('updatedAt', 'updatedAt');\r\n          conversationStore.createIndex('title', 'title');\r\n        }\r\n\r\n        // Store for individual messages within conversations\r\n        if (!db.objectStoreNames.contains('messages')) {\r\n          const messageStore = db.createObjectStore('messages', { keyPath: 'id' });\r\n          // Index to quickly fetch all messages for a conversation\r\n          messageStore.createIndex('conversationId', 'conversationId');\r\n          messageStore.createIndex('timestamp', 'timestamp');\r\n        }\r\n      };\r\n\r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => resolve(request.result);\r\n    });\r\n  }\r\n\r\n  // Conversation management methods\r\n  async createConversation(title: string, models: { responder: string; listener: string }): Promise<string> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['conversations'], 'readwrite');\r\n      const store = transaction.objectStore('conversations');\r\n\r\n      const conversation: Conversation = {\r\n        id: generateId(),\r\n        title,\r\n        createdAt: Date.now(),\r\n        updatedAt: Date.now(),\r\n        models: {\r\n          responder: models.responder,\r\n          listener: models.listener,\r\n          contexts: {\r\n            [models.responder]: {\r\n              understanding: \"Initial conversation context.\",\r\n              lastUpdated: Date.now(),\r\n              messagesSeen: []\r\n            },\r\n            [models.listener]: {\r\n              understanding: \"Initial conversation context.\",\r\n              lastUpdated: Date.now(),\r\n              messagesSeen: []\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      const request = store.add(conversation);\r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => resolve(conversation.id);\r\n    });\r\n  }\r\n\r\n  async saveMessage(message: Message): Promise<void> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['messages', 'conversations'], 'readwrite');\r\n      \r\n      // Save the message\r\n      const messageStore = transaction.objectStore('messages');\r\n      messageStore.add(message);\r\n\r\n      // Update the conversation's updatedAt timestamp\r\n      const conversationStore = transaction.objectStore('conversations');\r\n      const getConversation = conversationStore.get(message.conversationId);\r\n      \r\n      getConversation.onsuccess = () => {\r\n        const conversation = getConversation.result;\r\n        conversation.updatedAt = Date.now();\r\n        conversationStore.put(conversation);\r\n      };\r\n\r\n      transaction.oncomplete = () => resolve();\r\n      transaction.onerror = () => reject(transaction.error);\r\n    });\r\n  }\r\n\r\n  // Retrieval methods with useful filters and sorting\r\n  async getConversations(): Promise<Conversation[]> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['conversations'], 'readonly');\r\n      const store = transaction.objectStore('conversations');\r\n      const index = store.index('updatedAt');\r\n      \r\n      // Get conversations sorted by most recently updated\r\n      const request = index.getAll();\r\n      \r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => {\r\n        const conversations = request.result;\r\n        resolve(conversations.sort((a, b) => b.updatedAt - a.updatedAt));\r\n      };\r\n    });\r\n  }\r\n\r\n  async updateModelContext(\r\n    conversationId: string,\r\n    modelName: string,\r\n    context: ModelContext\r\n  ): Promise<void> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['conversations'], 'readwrite');\r\n      const store = transaction.objectStore('conversations');\r\n      \r\n      const getRequest = store.get(conversationId);\r\n      getRequest.onsuccess = () => {\r\n        const conversation = getRequest.result;\r\n        conversation.models.contexts[modelName] = context;\r\n        conversation.updatedAt = Date.now();\r\n        store.put(conversation);\r\n      };\r\n\r\n      transaction.oncomplete = () => resolve();\r\n      transaction.onerror = () => reject(transaction.error);\r\n    });\r\n  }\r\n\r\n  async switchModelRoles(conversationId: string): Promise<void> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['conversations'], 'readwrite');\r\n      const store = transaction.objectStore('conversations');\r\n      \r\n      const getRequest = store.get(conversationId);\r\n      getRequest.onsuccess = () => {\r\n        const conversation = getRequest.result;\r\n        if (!conversation) {\r\n          reject(new Error('Conversation not found'));\r\n          return;\r\n        }\r\n\r\n        // Swap the roles while preserving contexts\r\n        const oldResponder = conversation.models.responder;\r\n        const oldListener = conversation.models.listener;\r\n        \r\n        conversation.models = {\r\n          responder: oldListener,\r\n          listener: oldResponder,\r\n          contexts: conversation.models.contexts\r\n        };\r\n        \r\n        conversation.updatedAt = Date.now();\r\n        store.put(conversation);\r\n      };\r\n\r\n      transaction.oncomplete = () => resolve();\r\n      transaction.onerror = () => reject(transaction.error);\r\n    });\r\n  }\r\n\r\n  async addSystemMessage(conversationId: string, content: string): Promise<Message> {\r\n    const message: Message = {\r\n      id: generateId(),\r\n      conversationId,\r\n      role: 'system',\r\n      content,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    await this.saveMessage(message);\r\n    return message;\r\n  }\r\n\r\n  async getConversation(conversationId: string): Promise<Conversation> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['conversations'], 'readonly');\r\n      const store = transaction.objectStore('conversations');\r\n      \r\n      const request = store.get(conversationId);\r\n      \r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => resolve(request.result);\r\n    });\r\n  }\r\n\r\n  async getConversationMessages(conversationId: string): Promise<Message[]> {\r\n    const db = await this.initDB();\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(['messages'], 'readonly');\r\n      const store = transaction.objectStore('messages');\r\n      const index = store.index('conversationId');\r\n      \r\n      const request = index.getAll(IDBKeyRange.only(conversationId));\r\n      \r\n      request.onerror = () => reject(request.error);\r\n      request.onsuccess = () => {\r\n        const messages = request.result;\r\n        resolve(messages.sort((a, b) => a.timestamp - b.timestamp));\r\n      };\r\n    });\r\n  }\r\n}\r\n\r\nexport const storage = new StorageManager();\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/llm/providers/ollama-provider.ts"],"sourcesContent":["import { LLMProvider, StreamResponse } from '../types';\r\n\r\nexport class OllamaProvider implements LLMProvider {\r\n  name = 'Ollama';\r\n  endpoint = 'http://localhost:11434';\r\n  private model: string;\r\n  private context: number[] | null = null;\r\n\r\n  constructor(model: string) {\r\n    this.model = model;\r\n  }\r\n\r\n  async getResponse(prompt: string): Promise<string> {\r\n    const response = await fetch(`${this.endpoint}/api/generate`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model: this.model,\r\n        prompt,\r\n        stream: false,\r\n        context: this.context\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Ollama API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    if (data.context) {\r\n      this.context = data.context;\r\n    }\r\n\r\n    return data.response;\r\n  }\r\n\r\n  async *streamResponse(prompt: string) {\r\n    const response = await fetch(`${this.endpoint}/api/generate`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model: this.model,\r\n        prompt,\r\n        stream: true,\r\n        context: this.context\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Ollama API error: ${response.status}`);\r\n    }\r\n\r\n    const reader = response.body?.getReader();\r\n    if (!reader) {\r\n      throw new Error('Response body is null');\r\n    }\r\n\r\n    const decoder = new TextDecoder();\r\n    let buffer = '';\r\n\r\n    while (true) {\r\n      const { done, value } = await reader.read();\r\n      if (done) break;\r\n\r\n      buffer += decoder.decode(value, { stream: true });\r\n      const lines = buffer.split('\\n');\r\n      buffer = lines.pop() || '';\r\n\r\n      for (const line of lines) {\r\n        if (line.trim()) {\r\n          try {\r\n            const chunk: StreamResponse = JSON.parse(line);\r\n            if (chunk.context) {\r\n              this.context = chunk.context;\r\n            }\r\n            yield chunk;\r\n          } catch (e) {\r\n            console.error('Error parsing chunk:', e);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  clearContext() {\r\n    this.context = null;\r\n  }\r\n}"],"names":[],"mappings":";;;AAEO,MAAM;IACX,OAAO,SAAS;IAChB,WAAW,yBAAyB;IAC5B,MAAc;IACd,UAA2B,KAAK;IAExC,YAAY,KAAa,CAAE;QACzB,IAAI,CAAC,KAAK,GAAG;IACf;IAEA,MAAM,YAAY,MAAc,EAAmB;QACjD,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;YAC5D,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO,IAAI,CAAC,KAAK;gBACjB;gBACA,QAAQ;gBACR,SAAS,IAAI,CAAC,OAAO;YACvB;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,kBAAkB,EAAE,SAAS,MAAM,EAAE;QACxD;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,IAAI,KAAK,OAAO,EAAE;YAChB,IAAI,CAAC,OAAO,GAAG,KAAK,OAAO;QAC7B;QAEA,OAAO,KAAK,QAAQ;IACtB;IAEA,OAAO,eAAe,MAAc,EAAE;QACpC,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;YAC5D,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO,IAAI,CAAC,KAAK;gBACjB;gBACA,QAAQ;gBACR,SAAS,IAAI,CAAC,OAAO;YACvB;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,kBAAkB,EAAE,SAAS,MAAM,EAAE;QACxD;QAEA,MAAM,SAAS,SAAS,IAAI,EAAE;QAC9B,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,UAAU,IAAI;QACpB,IAAI,SAAS;QAEb,MAAO,KAAM;YACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,IAAI;YACzC,IAAI,MAAM;YAEV,UAAU,QAAQ,MAAM,CAAC,OAAO;gBAAE,QAAQ;YAAK;YAC/C,MAAM,QAAQ,OAAO,KAAK,CAAC;YAC3B,SAAS,MAAM,GAAG,MAAM;YAExB,KAAK,MAAM,QAAQ,MAAO;gBACxB,IAAI,KAAK,IAAI,IAAI;oBACf,IAAI;wBACF,MAAM,QAAwB,KAAK,KAAK,CAAC;wBACzC,IAAI,MAAM,OAAO,EAAE;4BACjB,IAAI,CAAC,OAAO,GAAG,MAAM,OAAO;wBAC9B;wBACA,MAAM;oBACR,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC,wBAAwB;oBACxC;gBACF;YACF;QACF;IACF;IAEA,eAAe;QACb,IAAI,CAAC,OAAO,GAAG;IACjB;AACF"}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 319, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/llm/multi-provider-chat.ts"],"sourcesContent":["import { LLMProvider, LLMConfig, ChatMessage } from './types';\r\nimport { OllamaProvider } from './providers/ollama-provider';\r\nimport { LMStudioProvider } from './providers/lm-studio-provider';\r\n\r\nexport class SequentialChat {\r\n  private providers: Map<string, LLMProvider> = new Map();\r\n  private activeProvider: LLMProvider | null = null;\r\n  private conversationHistory: ChatMessage[] = [];\r\n\r\n  constructor(providers: { [key: string]: LLMProvider }) {\r\n    Object.entries(providers).forEach(([key, provider]) => {\r\n      this.providers.set(key, provider);\r\n    });\r\n    // Set first provider as active by default\r\n    this.activeProvider = Object.values(providers)[0];\r\n  }\r\n\r\n  setActiveProvider(providerKey: string) {\r\n    const provider = this.providers.get(providerKey);\r\n    if (!provider) {\r\n      throw new Error(`Provider ${providerKey} not found`);\r\n    }\r\n    this.activeProvider = provider;\r\n  }\r\n\r\n  async getResponse(message: string, config: LLMConfig = {}): Promise<string> {\r\n    if (!this.activeProvider) {\r\n      throw new Error('No active provider set');\r\n    }\r\n\r\n    // Add user message to history\r\n    this.conversationHistory.push({\r\n      role: 'user',\r\n      content: message,\r\n      provider: this.activeProvider.name\r\n    });\r\n\r\n    try {\r\n      const response = await this.activeProvider.getResponse(message);\r\n\r\n      // Add assistant response to history\r\n      this.conversationHistory.push({\r\n        role: 'assistant',\r\n        content: response,\r\n        provider: this.activeProvider.name\r\n      });\r\n\r\n      return response;\r\n    } catch (error) {\r\n      console.error(`Error from ${this.activeProvider.name}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async *streamResponse(message: string, config: LLMConfig = {}) {\r\n    if (!this.activeProvider) {\r\n      throw new Error('No active provider set');\r\n    }\r\n\r\n    if (!this.activeProvider.streamResponse) {\r\n      throw new Error(`${this.activeProvider.name} does not support streaming`);\r\n    }\r\n\r\n    this.conversationHistory.push({\r\n      role: 'user',\r\n      content: message,\r\n      provider: this.activeProvider.name\r\n    });\r\n\r\n    let fullResponse = '';\r\n\r\n    try {\r\n      for await (const chunk of this.activeProvider.streamResponse(message)) {\r\n        if (chunk.response) {\r\n          fullResponse += chunk.response;\r\n          yield chunk;\r\n        }\r\n      }\r\n\r\n      this.conversationHistory.push({\r\n        role: 'assistant',\r\n        content: fullResponse,\r\n        provider: this.activeProvider.name\r\n      });\r\n    } catch (error) {\r\n      console.error(`Streaming error from ${this.activeProvider.name}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  getConversationHistory() {\r\n    return this.conversationHistory;\r\n  }\r\n\r\n  clearHistory() {\r\n    this.conversationHistory = [];\r\n    // Clear context for providers that support it\r\n    this.providers.forEach(provider => {\r\n      if (provider instanceof OllamaProvider) {\r\n        provider.clearContext();\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n// Example usage:\r\n/*\r\nconst chat = new SequentialChat({\r\n  ollama: new OllamaProvider('deepseek-r1:14b'),\r\n  lmStudio: new LMStudioProvider('qwen2.5-coder')\r\n});\r\n\r\n// Start with Ollama\r\nchat.setActiveProvider('ollama');\r\nconst ollamaResponse = await chat.getResponse('What is TypeScript?');\r\nconsole.log('Ollama:', ollamaResponse);\r\n\r\n// Switch to LM Studio for implementation details\r\nchat.setActiveProvider('lmStudio');\r\nconst lmStudioResponse = await chat.getResponse('How would you implement this in Python?');\r\nconsole.log('LM Studio:', lmStudioResponse);\r\n\r\n// Switch back to Ollama for architecture discussion\r\nchat.setActiveProvider('ollama');\r\nconst architectureResponse = await chat.getResponse('What are the architectural implications?');\r\nconsole.log('Ollama:', architectureResponse);\r\n*/"],"names":[],"mappings":";;;AACA;;AAGO,MAAM;IACH,YAAsC,IAAI,MAAM;IAChD,iBAAqC,KAAK;IAC1C,sBAAqC,EAAE,CAAC;IAEhD,YAAY,SAAyC,CAAE;QACrD,OAAO,OAAO,CAAC,WAAW,OAAO,CAAC,CAAC,CAAC,KAAK,SAAS;YAChD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK;QAC1B;QACA,0CAA0C;QAC1C,IAAI,CAAC,cAAc,GAAG,OAAO,MAAM,CAAC,UAAU,CAAC,EAAE;IACnD;IAEA,kBAAkB,WAAmB,EAAE;QACrC,MAAM,WAAW,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;QACpC,IAAI,CAAC,UAAU;YACb,MAAM,IAAI,MAAM,CAAC,SAAS,EAAE,YAAY,UAAU,CAAC;QACrD;QACA,IAAI,CAAC,cAAc,GAAG;IACxB;IAEA,MAAM,YAAY,OAAe,EAAE,SAAoB,CAAC,CAAC,EAAmB;QAC1E,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACxB,MAAM,IAAI,MAAM;QAClB;QAEA,8BAA8B;QAC9B,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC;YAC5B,MAAM;YACN,SAAS;YACT,UAAU,IAAI,CAAC,cAAc,CAAC,IAAI;QACpC;QAEA,IAAI;YACF,MAAM,WAAW,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;YAEvD,oCAAoC;YACpC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC;gBAC5B,MAAM;gBACN,SAAS;gBACT,UAAU,IAAI,CAAC,cAAc,CAAC,IAAI;YACpC;YAEA,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,CAAC,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;YACzD,MAAM;QACR;IACF;IAEA,OAAO,eAAe,OAAe,EAAE,SAAoB,CAAC,CAAC,EAAE;QAC7D,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACxB,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE;YACvC,MAAM,IAAI,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,2BAA2B,CAAC;QAC1E;QAEA,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC;YAC5B,MAAM;YACN,SAAS;YACT,UAAU,IAAI,CAAC,cAAc,CAAC,IAAI;QACpC;QAEA,IAAI,eAAe;QAEnB,IAAI;YACF,WAAW,MAAM,SAAS,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,SAAU;gBACrE,IAAI,MAAM,QAAQ,EAAE;oBAClB,gBAAgB,MAAM,QAAQ;oBAC9B,MAAM;gBACR;YACF;YAEA,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC;gBAC5B,MAAM;gBACN,SAAS;gBACT,UAAU,IAAI,CAAC,cAAc,CAAC,IAAI;YACpC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,CAAC,qBAAqB,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;YACnE,MAAM;QACR;IACF;IAEA,yBAAyB;QACvB,OAAO,IAAI,CAAC,mBAAmB;IACjC;IAEA,eAAe;QACb,IAAI,CAAC,mBAAmB,GAAG,EAAE;QAC7B,8CAA8C;QAC9C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAA;YACrB,IAAI,oBAAoB,oJAAA,CAAA,iBAAc,EAAE;gBACtC,SAAS,YAAY;YACvB;QACF;IACF;AACF,EAEA,iBAAiB;CACjB;;;;;;;;;;;;;;;;;;;;AAoBA"}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 436, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/llm/providers/lm-studio-provider.ts"],"sourcesContent":["import { LLMProvider, ChatMessage } from '../types';\r\n\r\nexport class LMStudioProvider implements LLMProvider {\r\n  name = 'LM Studio';\r\n  endpoint = 'http://127.0.0.1:1234';\r\n  private model: string;\r\n\r\n  constructor(model: string) {\r\n    this.model = model;\r\n  }\r\n\r\n  async getResponse(prompt: string): Promise<string> {\r\n    const messages: ChatMessage[] = [\r\n      { role: 'user', content: prompt }\r\n    ];\r\n\r\n    const response = await fetch(`${this.endpoint}/v1/chat/completions`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model: this.model,\r\n        messages,\r\n        stream: false\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`LM Studio API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.choices[0].message.content;\r\n  }\r\n\r\n  // Note: LM Studio's streaming implementation follows OpenAI's format\r\n  async *streamResponse(prompt: string) {\r\n    const messages: ChatMessage[] = [\r\n      { role: 'user', content: prompt }\r\n    ];\r\n\r\n    const response = await fetch(`${this.endpoint}/v1/chat/completions`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model: this.model,\r\n        messages,\r\n        stream: true\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`LM Studio API error: ${response.status}`);\r\n    }\r\n\r\n    const reader = response.body?.getReader();\r\n    if (!reader) {\r\n      throw new Error('Response body is null');\r\n    }\r\n\r\n    const decoder = new TextDecoder();\r\n    let buffer = '';\r\n\r\n    while (true) {\r\n      const { done, value } = await reader.read();\r\n      if (done) break;\r\n\r\n      buffer += decoder.decode(value, { stream: true });\r\n      const lines = buffer.split('\\n');\r\n      buffer = lines.pop() || '';\r\n\r\n      for (const line of lines) {\r\n        if (line.trim() && line.startsWith('data: ')) {\r\n          try {\r\n            const jsonData = line.slice(6); // Remove 'data: ' prefix\r\n            if (jsonData === '[DONE]') continue;\r\n\r\n            const parsed = JSON.parse(jsonData);\r\n            if (parsed.choices?.[0]?.delta?.content) {\r\n              yield {\r\n                model: this.model,\r\n                created_at: new Date().toISOString(),\r\n                response: parsed.choices[0].delta.content,\r\n                done: false\r\n              };\r\n            }\r\n          } catch (e) {\r\n            console.error('Error parsing streaming response:', e);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}"],"names":[],"mappings":";;;AAEO,MAAM;IACX,OAAO,YAAY;IACnB,WAAW,wBAAwB;IAC3B,MAAc;IAEtB,YAAY,KAAa,CAAE;QACzB,IAAI,CAAC,KAAK,GAAG;IACf;IAEA,MAAM,YAAY,MAAc,EAAmB;QACjD,MAAM,WAA0B;YAC9B;gBAAE,MAAM;gBAAQ,SAAS;YAAO;SACjC;QAED,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,EAAE;YACnE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO,IAAI,CAAC,KAAK;gBACjB;gBACA,QAAQ;YACV;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,qBAAqB,EAAE,SAAS,MAAM,EAAE;QAC3D;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO;IACxC;IAEA,qEAAqE;IACrE,OAAO,eAAe,MAAc,EAAE;QACpC,MAAM,WAA0B;YAC9B;gBAAE,MAAM;gBAAQ,SAAS;YAAO;SACjC;QAED,MAAM,WAAW,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,oBAAoB,CAAC,EAAE;YACnE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO,IAAI,CAAC,KAAK;gBACjB;gBACA,QAAQ;YACV;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,qBAAqB,EAAE,SAAS,MAAM,EAAE;QAC3D;QAEA,MAAM,SAAS,SAAS,IAAI,EAAE;QAC9B,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,UAAU,IAAI;QACpB,IAAI,SAAS;QAEb,MAAO,KAAM;YACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,IAAI;YACzC,IAAI,MAAM;YAEV,UAAU,QAAQ,MAAM,CAAC,OAAO;gBAAE,QAAQ;YAAK;YAC/C,MAAM,QAAQ,OAAO,KAAK,CAAC;YAC3B,SAAS,MAAM,GAAG,MAAM;YAExB,KAAK,MAAM,QAAQ,MAAO;gBACxB,IAAI,KAAK,IAAI,MAAM,KAAK,UAAU,CAAC,WAAW;oBAC5C,IAAI;wBACF,MAAM,WAAW,KAAK,KAAK,CAAC,IAAI,yBAAyB;wBACzD,IAAI,aAAa,UAAU;wBAE3B,MAAM,SAAS,KAAK,KAAK,CAAC;wBAC1B,IAAI,OAAO,OAAO,EAAE,CAAC,EAAE,EAAE,OAAO,SAAS;4BACvC,MAAM;gCACJ,OAAO,IAAI,CAAC,KAAK;gCACjB,YAAY,IAAI,OAAO,WAAW;gCAClC,UAAU,OAAO,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO;gCACzC,MAAM;4BACR;wBACF;oBACF,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC,qCAAqC;oBACrD;gBACF;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 528, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/llm/test-sequential-chat.ts"],"sourcesContent":["import { SequentialChat } from './multi-provider-chat';\r\nimport { OllamaProvider } from './providers/ollama-provider';\r\nimport { LMStudioProvider } from './providers/lm-studio-provider';\r\n\r\nasync function testSequentialChat() {\r\n  // Initialize providers with specific models\r\n  const chat = new SequentialChat({\r\n    ollama: new OllamaProvider('deepseek-r1:14b'),  // Using DeepSeek for Ollama\r\n    lmStudio: new LMStudioProvider('qwen2.5-coder') // Using Qwen for LM Studio\r\n  });\r\n\r\n  try {\r\n    // Test 1: Use Ollama for initial question\r\n    console.log('\\n=== Test 1: Ollama Initial Question ===');\r\n    chat.setActiveProvider('ollama');\r\n    const ollamaResponse = await chat.getResponse(\r\n      'What are the key differences between TypeScript and JavaScript?'\r\n    );\r\n    console.log('Ollama Response:', ollamaResponse);\r\n\r\n    // Test 2: Switch to LM Studio for implementation details\r\n    console.log('\\n=== Test 2: LM Studio Implementation Details ===');\r\n    chat.setActiveProvider('lmStudio');\r\n    const lmStudioResponse = await chat.getResponse(\r\n      'Based on the previous explanation, show me how to implement a TypeScript interface with generics.'\r\n    );\r\n    console.log('LM Studio Response:', lmStudioResponse);\r\n\r\n    // Test 3: Back to Ollama for architectural discussion\r\n    console.log('\\n=== Test 3: Ollama Architecture Discussion ===');\r\n    chat.setActiveProvider('ollama');\r\n    const architectureResponse = await chat.getResponse(\r\n      'What are the architectural benefits of using TypeScript in a large-scale application?'\r\n    );\r\n    console.log('Ollama Architecture Response:', architectureResponse);\r\n\r\n    // Test 4: Streaming response from Ollama\r\n    console.log('\\n=== Test 4: Ollama Streaming Response ===');\r\n    chat.setActiveProvider('ollama');\r\n    console.log('Streaming response (each chunk on new line):');\r\n    for await (const chunk of chat.streamResponse(\r\n      'Explain how TypeScript\\'s type system helps with refactoring.'\r\n    )) {\r\n      process.stdout.write(chunk.response);\r\n    }\r\n    console.log('\\n');\r\n\r\n    // Get conversation history\r\n    console.log('\\n=== Conversation History ===');\r\n    const history = chat.getConversationHistory();\r\n    history.forEach((msg, i) => {\r\n      console.log(`${i + 1}. [${msg.provider}] ${msg.role}: ${msg.content.substring(0, 50)}...`);\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error during sequential chat test:', error);\r\n  } finally {\r\n    // Clean up\r\n    chat.clearHistory();\r\n  }\r\n}\r\n\r\n// Run the test if this file is executed directly\r\nif (require.main === module) {\r\n  console.log('Starting Sequential Chat Test...');\r\n  testSequentialChat().then(() => {\r\n    console.log('Test completed.');\r\n  }).catch(error => {\r\n    console.error('Test failed:', error);\r\n  });\r\n}\r\n\r\n/*\r\nTo run this test:\r\n1. Make sure Ollama is running with the deepseek-r1:14b model:\r\n   ollama run deepseek-r1:14b\r\n\r\n2. Make sure LM Studio is running with the qwen2.5-coder model loaded\r\n   and the API server enabled on port 1234\r\n\r\n3. Run the test:\r\n   ts-node src/lib/llm/test-sequential-chat.ts\r\n*/"],"names":[],"mappings":";AAAA;AACA;AACA;;;;AAEA,eAAe;IACb,4CAA4C;IAC5C,MAAM,OAAO,IAAI,8IAAA,CAAA,iBAAc,CAAC;QAC9B,QAAQ,IAAI,oJAAA,CAAA,iBAAc,CAAC;QAC3B,UAAU,IAAI,0JAAA,CAAA,mBAAgB,CAAC,iBAAiB,2BAA2B;IAC7E;IAEA,IAAI;QACF,0CAA0C;QAC1C,QAAQ,GAAG,CAAC;QACZ,KAAK,iBAAiB,CAAC;QACvB,MAAM,iBAAiB,MAAM,KAAK,WAAW,CAC3C;QAEF,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,yDAAyD;QACzD,QAAQ,GAAG,CAAC;QACZ,KAAK,iBAAiB,CAAC;QACvB,MAAM,mBAAmB,MAAM,KAAK,WAAW,CAC7C;QAEF,QAAQ,GAAG,CAAC,uBAAuB;QAEnC,sDAAsD;QACtD,QAAQ,GAAG,CAAC;QACZ,KAAK,iBAAiB,CAAC;QACvB,MAAM,uBAAuB,MAAM,KAAK,WAAW,CACjD;QAEF,QAAQ,GAAG,CAAC,iCAAiC;QAE7C,yCAAyC;QACzC,QAAQ,GAAG,CAAC;QACZ,KAAK,iBAAiB,CAAC;QACvB,QAAQ,GAAG,CAAC;QACZ,WAAW,MAAM,SAAS,KAAK,cAAc,CAC3C,iEACC;YACD,QAAQ,MAAM,CAAC,KAAK,CAAC,MAAM,QAAQ;QACrC;QACA,QAAQ,GAAG,CAAC;QAEZ,2BAA2B;QAC3B,QAAQ,GAAG,CAAC;QACZ,MAAM,UAAU,KAAK,sBAAsB;QAC3C,QAAQ,OAAO,CAAC,CAAC,KAAK;YACpB,QAAQ,GAAG,CAAC,GAAG,IAAI,EAAE,GAAG,EAAE,IAAI,QAAQ,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,EAAE,EAAE,IAAI,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC;QAC3F;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sCAAsC;IACtD,SAAU;QACR,WAAW;QACX,KAAK,YAAY;IACnB;AACF;AAEA,iDAAiD;AACjD,IAAI,4DAAQ,IAAI,KAAK,QAAQ;IAC3B,QAAQ,GAAG,CAAC;IACZ,qBAAqB,IAAI,CAAC;QACxB,QAAQ,GAAG,CAAC;IACd,GAAG,KAAK,CAAC,CAAA;QACP,QAAQ,KAAK,CAAC,gBAAgB;IAChC;AACF,EAEA;;;;;;;;;;AAUA"}},
    {"offset": {"line": 603, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 609, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/chat/message-handler.ts"],"sourcesContent":["import { Conversation, Message, ModelContext } from '../storage/types';\r\nimport { StorageManager } from '../storage/db';\r\nimport { SequentialChat } from '../llm/test-sequential-chat';\r\n\r\nexport class MessageHandler {\r\n  private sequentialChat: SequentialChat;\r\n\r\n  constructor(\r\n    private storage: StorageManager\r\n  ) {\r\n    this.sequentialChat = new SequentialChat();\r\n  }\r\n\r\n  async processNewMessage(\r\n    conversation: Conversation,\r\n    content: string,\r\n    role: 'user' | 'assistant'\r\n  ) {\r\n    try {\r\n      // First, save the new message\r\n      const message = await this.saveMessage(conversation.id, content, role);\r\n\r\n      // If this is a user message, we need to:\r\n      // 1. Update the listener's context\r\n      // 2. Get a response from the responder\r\n      if (role === 'user') {\r\n        try {\r\n          // Switch to listener model for context update\r\n          await this.sequentialChat.switchProvider('lmstudio');\r\n          await this.updateListenerContext(conversation, message);\r\n        } catch (error) {\r\n          console.error('Failed to update listener context:', error);\r\n          // Continue even if listener update fails\r\n        }\r\n        \r\n        // Switch to responder model for reply\r\n        await this.sequentialChat.switchProvider('ollama');\r\n        const response = await this.getResponderReply(conversation, message);\r\n        \r\n        // Save the response as a new message\r\n        await this.saveMessage(conversation.id, response, 'assistant');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error in processNewMessage:', error);\r\n      throw new Error(`Failed to process message: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  private async saveMessage(\r\n    conversationId: string,\r\n    content: string,\r\n    role: 'user' | 'assistant' | 'system'\r\n  ): Promise<Message> {\r\n    const message: Message = {\r\n      id: Date.now().toString(),\r\n      conversationId,\r\n      role,\r\n      content,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    await this.storage.saveMessage(message);\r\n    return message;\r\n  }\r\n\r\n  private async updateListenerContext(\r\n    conversation: Conversation,\r\n    newMessage: Message\r\n  ) {\r\n    if (!conversation.models) {\r\n      throw new Error('Models not configured for conversation');\r\n    }\r\n\r\n    const listenerModel = conversation.models.listener;\r\n    if (!listenerModel) {\r\n      throw new Error('Listener model not configured for conversation');\r\n    }\r\n\r\n    // Ensure contexts object exists and is properly initialized\r\n    if (!conversation.models.contexts || typeof conversation.models.contexts !== 'object') {\r\n      conversation.models.contexts = {};\r\n    }\r\n\r\n    // Initialize or get the current context\r\n    let currentContext = conversation.models.contexts[listenerModel];\r\n    if (!currentContext) {\r\n      currentContext = {\r\n        understanding: \"Initial conversation context.\",\r\n        lastUpdated: Date.now(),\r\n        messagesSeen: []\r\n      };\r\n      conversation.models.contexts[listenerModel] = currentContext;\r\n    }\r\n\r\n    try {\r\n      const prompt = `You are observing a conversation to build your understanding. \r\n      Your current understanding: ${currentContext.understanding}\r\n      \r\n      New message: ${newMessage.content}\r\n      \r\n      Update your understanding of the conversation, maintaining your unique perspective.\r\n      Focus on the key points that would be relevant if you need to respond later.`;\r\n\r\n      const response = await this.sequentialChat.chat(prompt);\r\n\r\n      // Update the listener's context in storage\r\n      await this.storage.updateModelContext(\r\n        conversation.id,\r\n        listenerModel,\r\n        {\r\n          understanding: response,\r\n          lastUpdated: Date.now(),\r\n          messagesSeen: [...currentContext.messagesSeen, parseInt(newMessage.id)]\r\n        }\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to update listener context:', error);\r\n    }\r\n  }\r\n\r\n  private async getResponderReply(\r\n    conversation: Conversation,\r\n    message: Message\r\n  ): Promise<string> {\r\n    try {\r\n      if (!conversation.models) {\r\n        throw new Error('Models not configured for conversation');\r\n      }\r\n\r\n      const responderModel = conversation.models.responder;\r\n      if (!responderModel) {\r\n        throw new Error('Responder model not configured for conversation');\r\n      }\r\n\r\n      // Get all messages in the conversation\r\n      const conversationMessages = await this.storage.getConversationMessages(conversation.id);\r\n      \r\n      // Build the conversation history as a single prompt\r\n      const history = conversationMessages\r\n        .map(msg => `${msg.role === 'user' ? 'User' : 'Assistant'}: ${msg.content}`)\r\n        .join('\\n');\r\n      \r\n      const prompt = `You are ${responderModel}, an AI assistant. Be helpful, clear, and concise in your responses.\r\n      \r\nPrevious conversation:\r\n${history}\r\n\r\nUser: ${message.content}`;\r\n\r\n      const response = await this.sequentialChat.chat(prompt);\r\n      return response;\r\n    } catch (error: any) {\r\n      console.error('Error in getResponderReply:', error);\r\n      throw new Error(`Failed to get AI response: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  async addSystemMessage(conversationId: string, content: string): Promise<Message> {\r\n    return this.saveMessage(conversationId, content, 'system');\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 733, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 739, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n\r\nexport function generateId(): string {\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n    const r = Math.random() * 16 | 0;\r\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n    return v.toString(16);\r\n  });\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,yNAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,sLAAA,CAAA,OAAI,AAAD,EAAE;AACtB;AAEO,SAAS;IACd,OAAO,uCAAuC,OAAO,CAAC,SAAS,SAAS,CAAC;QACvE,MAAM,IAAI,KAAK,MAAM,KAAK,KAAK;QAC/B,MAAM,IAAI,MAAM,MAAM,IAAK,IAAI,MAAM;QACrC,OAAO,EAAE,QAAQ,CAAC;IACpB;AACF"}},
    {"offset": {"line": 757, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 763, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\r\n  variant?: 'default' | 'outline' | 'ghost';\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  ({ className, variant = 'default', ...props }, ref) => {\r\n    return (\r\n      <button\r\n        className={cn(\r\n          \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background\",\r\n          {\r\n            \"bg-primary text-primary-foreground hover:bg-primary/90\": variant === 'default',\r\n            \"border border-input hover:bg-accent hover:text-accent-foreground\": variant === 'outline',\r\n            \"hover:bg-accent hover:text-accent-foreground\": variant === 'ghost',\r\n          },\r\n          \"h-10 py-2 px-4\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    );\r\n  }\r\n);\r\n\r\nButton.displayName = \"Button\";\r\n\r\nexport { Button };\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAOA,MAAM,uBAAS,4WAAM,UAAU,CAC7B,CAAC,EAAE,SAAS,EAAE,UAAU,SAAS,EAAE,GAAG,OAAO,EAAE;IAC7C,qBACE,oZAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,wQACA;YACE,0DAA0D,YAAY;YACtE,oEAAoE,YAAY;YAChF,gDAAgD,YAAY;QAC9D,GACA,kBACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAGF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 789, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 795, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { cn } from \"../../lib/utils\";\r\n\r\nexport interface InputProps\r\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n  ({ className, type, ...props }, ref) => {\r\n    return (\r\n      <input\r\n        type={type}\r\n        className={cn(\r\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    );\r\n  }\r\n);\r\n\r\nInput.displayName = \"Input\";\r\n\r\nexport { Input };\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAKA,MAAM,sBAAQ,4WAAM,UAAU,CAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,oZAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,gWACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAGF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 818, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 824, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-background text-foreground\",\r\n        destructive:\r\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Alert = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\r\n>(({ className, variant, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    role=\"alert\"\r\n    className={cn(alertVariants({ variant }), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlert.displayName = \"Alert\"\r\n\r\nconst AlertTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h5\r\n    ref={ref}\r\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertTitle.displayName = \"AlertTitle\"\r\n\r\nconst AlertDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDescription.displayName = \"AlertDescription\"\r\n\r\nexport { Alert, AlertTitle, AlertDescription }\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,2OAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,4WAAM,UAAU,CAG5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,oZAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,4WAAM,UAAU,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oZAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,4WAAM,UAAU,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,oZAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG"}},
    {"offset": {"line": 882, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 888, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/ollama/test-connection.ts"],"sourcesContent":["export async function testOllamaConnection() {\r\n  try {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout\r\n\r\n    const response = await fetch('/api/test-connection', {\r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json'\r\n      },\r\n      signal: controller.signal\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n    \r\n    const data = await response.json();\r\n    console.log('Ollama test response:', data);\r\n    \r\n    if (!response.ok || !data.success) {\r\n      throw new Error(data.error || `Connection test failed: ${response.statusText}`);\r\n    }\r\n    \r\n    return {\r\n      success: true,\r\n      deepseek: data.deepseek,\r\n      qwen: data.qwen\r\n    };\r\n  } catch (error: any) {\r\n    console.error('Ollama connection test failed:', error);\r\n    \r\n    if (error.name === 'AbortError') {\r\n      throw new Error('Connection test timed out. Please check if Ollama server is responding.');\r\n    }\r\n    \r\n    throw new Error(error.message || 'Failed to connect to Ollama server');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAO,eAAe;IACpB,IAAI;QACF,MAAM,aAAa,IAAI;QACvB,MAAM,YAAY,WAAW,IAAM,WAAW,KAAK,IAAI,QAAQ,oBAAoB;QAEnF,MAAM,WAAW,MAAM,MAAM,wBAAwB;YACnD,QAAQ;YACR,SAAS;gBACP,UAAU;YACZ;YACA,QAAQ,WAAW,MAAM;QAC3B;QAEA,aAAa;QAEb,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,QAAQ,GAAG,CAAC,yBAAyB;QAErC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,OAAO,EAAE;YACjC,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;QAChF;QAEA,OAAO;YACL,SAAS;YACT,UAAU,KAAK,QAAQ;YACvB,MAAM,KAAK,IAAI;QACjB;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,kCAAkC;QAEhD,IAAI,MAAM,IAAI,KAAK,cAAc;YAC/B,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;AACF"}},
    {"offset": {"line": 921, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 927, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/lib/ollama/connection.ts"],"sourcesContent":["import { testOllamaConnection } from './test-connection';\r\n\r\nexport async function verifyOllamaSetup(): Promise<{ success: boolean; error?: string }> {\r\n  try {\r\n    const result = await testOllamaConnection();\r\n    console.log('Setup verification succeeded:', result);\r\n    return { success: true };\r\n  } catch (error: any) {\r\n    console.error('Setup verification failed:', error);\r\n    return {\r\n      success: false,\r\n      error: error.message || 'Failed to connect to Ollama server'\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,CAAA,GAAA,0IAAA,CAAA,uBAAoB,AAAD;QACxC,QAAQ,GAAG,CAAC,iCAAiC;QAC7C,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;YACL,SAAS;YACT,OAAO,MAAM,OAAO,IAAI;QAC1B;IACF;AACF"}},
    {"offset": {"line": 947, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 953, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/conversation-list.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { Conversation } from '../lib/storage/types';\r\n\r\nexport function ConversationList({ \r\n  conversations, \r\n  currentId, \r\n  onSelect \r\n}: { \r\n  conversations: Conversation[];\r\n  currentId: string;\r\n  onSelect: (id: string) => void;\r\n}) {\r\n  return (\r\n    <div className=\"border-r w-64 p-4\">\r\n      <div className=\"space-y-2\">\r\n        {conversations.map(conversation => {\r\n          const activeModel = conversation.models.responder;\r\n          const timestamp = new Date(conversation.updatedAt).toLocaleDateString();\r\n          \r\n          return (\r\n            <button\r\n              key={conversation.id}\r\n              onClick={() => onSelect(conversation.id)}\r\n              className={`w-full text-left p-3 rounded-lg ${\r\n                conversation.id === currentId \r\n                  ? 'bg-blue-50 border-blue-200' \r\n                  : 'hover:bg-gray-50'\r\n              }`}\r\n            >\r\n              <div className=\"font-medium\">{conversation.title}</div>\r\n              <div className=\"text-sm text-gray-500\">\r\n                Responder: {activeModel}\r\n              </div>\r\n              <div className=\"text-xs text-gray-400\">{timestamp}</div>\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAIO,SAAS,iBAAiB,EAC/B,aAAa,EACb,SAAS,EACT,QAAQ,EAKT;IACC,qBACE,oZAAC;QAAI,WAAU;kBACb,cAAA,oZAAC;YAAI,WAAU;sBACZ,cAAc,GAAG,CAAC,CAAA;gBACjB,MAAM,cAAc,aAAa,MAAM,CAAC,SAAS;gBACjD,MAAM,YAAY,IAAI,KAAK,aAAa,SAAS,EAAE,kBAAkB;gBAErE,qBACE,oZAAC;oBAEC,SAAS,IAAM,SAAS,aAAa,EAAE;oBACvC,WAAW,CAAC,gCAAgC,EAC1C,aAAa,EAAE,KAAK,YAChB,+BACA,oBACJ;;sCAEF,oZAAC;4BAAI,WAAU;sCAAe,aAAa,KAAK;;;;;;sCAChD,oZAAC;4BAAI,WAAU;;gCAAwB;gCACzB;;;;;;;sCAEd,oZAAC;4BAAI,WAAU;sCAAyB;;;;;;;mBAZnC,aAAa,EAAE;;;;;YAe1B;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 1016, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1022, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/ui/model-role-switcher.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { Button } from \"./button\";\r\nimport { ArrowUpDown } from 'lucide-react';\r\n\r\n// This component will show which model is in which role and allow switching\r\nexport function ModelRoleSwitcher({ \r\n  models,\r\n  onSwitch,\r\n  disabled\r\n}: {\r\n  models: { responder: string; listener: string };\r\n  onSwitch: () => void;\r\n  disabled: boolean;\r\n}) {\r\n  return (\r\n    <div className=\"flex items-center gap-4 p-4 border-b\">\r\n      {/* The active responder is highlighted */}\r\n      <div className=\"flex-1 p-3 rounded-lg bg-blue-50 border border-blue-200\">\r\n        <div className=\"text-sm font-medium\">Responder</div>\r\n        <div className=\"text-blue-600\">{models.responder}</div>\r\n      </div>\r\n\r\n      {/* Switch button with clear visual feedback */}\r\n      <Button \r\n        variant=\"outline\"\r\n        onClick={onSwitch}\r\n        disabled={disabled}\r\n        title=\"Switch model roles\"\r\n        className=\"h-10 w-10 p-0\"\r\n      >\r\n        <ArrowUpDown className=\"h-4 w-4\" />\r\n      </Button>\r\n\r\n      {/* The listener is shown in a more subtle style */}\r\n      <div className=\"flex-1 p-3 rounded-lg bg-gray-50 border border-gray-200\">\r\n        <div className=\"text-sm font-medium\">Listener</div>\r\n        <div className=\"text-gray-600\">{models.listener}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAMO,SAAS,kBAAkB,EAChC,MAAM,EACN,QAAQ,EACR,QAAQ,EAKT;IACC,qBACE,oZAAC;QAAI,WAAU;;0BAEb,oZAAC;gBAAI,WAAU;;kCACb,oZAAC;wBAAI,WAAU;kCAAsB;;;;;;kCACrC,oZAAC;wBAAI,WAAU;kCAAiB,OAAO,SAAS;;;;;;;;;;;;0BAIlD,oZAAC,kIAAA,CAAA,SAAM;gBACL,SAAQ;gBACR,SAAS;gBACT,UAAU;gBACV,OAAM;gBACN,WAAU;0BAEV,cAAA,oZAAC,4SAAA,CAAA,cAAW;oBAAC,WAAU;;;;;;;;;;;0BAIzB,oZAAC;gBAAI,WAAU;;kCACb,oZAAC;wBAAI,WAAU;kCAAsB;;;;;;kCACrC,oZAAC;wBAAI,WAAU;kCAAiB,OAAO,QAAQ;;;;;;;;;;;;;;;;;;AAIvD"}},
    {"offset": {"line": 1111, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1117, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/alex/testing-browser/audio-learning-hub/src/components/chat-panel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { storage } from '../lib/storage/db';\r\nimport { MessageHandler } from '../lib/chat/message-handler';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Alert, AlertTitle, AlertDescription } from './ui/alert';\r\nimport { verifyOllamaSetup } from '../lib/ollama/connection';\r\nimport { ConversationList } from './conversation-list';\r\nimport { ModelRoleSwitcher } from './ui/model-role-switcher';\r\nimport type { Message, Conversation } from '../lib/storage/types';\r\n\r\nexport function ChatPanel() {\r\n  const [currentConversation, setCurrentConversation] = useState<Conversation | null>(null);\r\n  const [conversations, setConversations] = useState<Conversation[]>([]);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [input, setInput] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isServerConnected, setIsServerConnected] = useState(false);\r\n  const [lastConnectionCheck, setLastConnectionCheck] = useState(0);\r\n\r\n  // Create a stable instance of MessageHandler\r\n  const messageHandler = useMemo(() => new MessageHandler(storage), []);\r\n\r\n  // Check Ollama server connection and verify model functionality\r\n  useEffect(() => {\r\n    async function verifyConnection() {\r\n      // Only check if it's been more than 10 seconds since the last check\r\n      const now = Date.now();\r\n      if (now - lastConnectionCheck < 10000) {\r\n        return;\r\n      }\r\n      \r\n      setLastConnectionCheck(now);\r\n      \r\n      try {\r\n        const result = await verifyOllamaSetup();\r\n        setIsServerConnected(result.success);\r\n        \r\n        if (!result.success) {\r\n          setError(result.error || 'Unable to connect to Ollama server or model test failed. Please ensure Ollama is running and the model is properly installed.');\r\n        } else {\r\n          setError(null);\r\n        }\r\n      } catch (error: any) {\r\n        setIsServerConnected(false);\r\n        setError(error.message || 'Ollama server not running or model test failed. Please start Ollama and ensure the model is installed.');\r\n      }\r\n    }\r\n    \r\n    verifyConnection();\r\n    // Check connection every minute\r\n    const interval = setInterval(verifyConnection, 60000);\r\n    return () => clearInterval(interval);\r\n  }, [lastConnectionCheck]);\r\n\r\n  // Load all conversations on mount\r\n  useEffect(() => {\r\n    async function loadConversations() {\r\n      try {\r\n        const allConversations = await storage.getConversations();\r\n        setConversations(allConversations);\r\n        \r\n        // If we have conversations, load the most recent one\r\n        if (allConversations.length > 0) {\r\n          await loadConversation(allConversations[0].id);\r\n        } else {\r\n          // Create a new conversation if none exist\r\n          const newId = await storage.createConversation('New Chat', {\r\n            responder: 'deepseek-r1:14b',\r\n            listener: 'qwen2.5-coder:latest'\r\n          });\r\n          const conversations = await storage.getConversations();\r\n          setConversations(conversations);\r\n          const newConversation = conversations.find(conv => conv.id === newId);\r\n          if (newConversation) {\r\n            setCurrentConversation(newConversation);\r\n            setMessages([]);\r\n          }\r\n        }\r\n    } catch (error: any) {\r\n      const errorMessage = error.message || 'Failed to initialize chat';\r\n      console.error(errorMessage, error);\r\n      setError(errorMessage);\r\n      }\r\n    }\r\n    \r\n    loadConversations();\r\n  }, []);\r\n\r\n  async function loadConversation(id: string) {\r\n    try {\r\n      const conversation = await storage.getConversation(id);\r\n      if (!conversation) {\r\n        throw new Error('Conversation not found');\r\n      }\r\n      \r\n      const messages = await storage.getConversationMessages(id);\r\n      setCurrentConversation(conversation);\r\n      setMessages(messages);\r\n    } catch (error: any) {\r\n      const errorMessage = error.message || 'Failed to load conversation';\r\n      console.error(errorMessage, error);\r\n      setError(errorMessage);\r\n    }\r\n  }\r\n\r\n  async function handleRoleSwitch() {\r\n    if (!currentConversation || isLoading) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // Add a system message to mark the switch\r\n      const switchMessage = await messageHandler.addSystemMessage(\r\n        currentConversation.id,\r\n        `Switching roles - ${currentConversation.models.listener} is now responding`\r\n      );\r\n      \r\n      // Update the conversation roles in storage\r\n      await storage.switchModelRoles(currentConversation.id);\r\n      \r\n      // Get the updated conversation\r\n      const updatedConversation = await storage.getConversation(currentConversation.id);\r\n      setCurrentConversation(updatedConversation);\r\n      \r\n      // Update messages to include the switch notification\r\n      setMessages(prev => [...prev, switchMessage]);\r\n    } catch (error: any) {\r\n      const errorMessage = error.message || 'Failed to switch roles';\r\n      console.error(errorMessage, error);\r\n      setError(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }\r\n\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (!input.trim() || isLoading || !currentConversation || !isServerConnected) return;\r\n\r\n    setIsLoading(true);\r\n    setError(null); // Clear any previous errors\r\n    \r\n    try {\r\n      // First save the user's message\r\n      const userMessage: Message = {\r\n        id: Date.now().toString(),\r\n        conversationId: currentConversation.id,\r\n        role: 'user',\r\n        content: input,\r\n        timestamp: Date.now()\r\n      };\r\n      await storage.saveMessage(userMessage);\r\n      setMessages(prev => [...prev, userMessage]);\r\n      setInput(''); // Clear input after sending\r\n\r\n      // Then process the message and get AI response\r\n      try {\r\n        await messageHandler.processNewMessage(currentConversation, input, 'user');\r\n        // Reload messages to get the AI response\r\n        const updatedMessages = await storage.getConversationMessages(currentConversation.id);\r\n        setMessages(updatedMessages);\r\n      } catch (error: any) {\r\n        // If the AI response fails, show the error but keep the user's message\r\n        const errorMessage = error.message || 'Failed to get AI response';\r\n        console.error(errorMessage, error);\r\n        setError(errorMessage);\r\n        \r\n        // Add a system message to indicate the error\r\n        const errorSystemMessage: Message = {\r\n          id: Date.now().toString(),\r\n          conversationId: currentConversation.id,\r\n          role: 'system',\r\n          content: `Error: ${errorMessage}. Please try again.`,\r\n          timestamp: Date.now()\r\n        };\r\n        await storage.saveMessage(errorSystemMessage);\r\n        setMessages(prev => [...prev, errorSystemMessage]);\r\n      }\r\n    } catch (error: any) {\r\n      const errorMessage = error.message || 'Failed to process message';\r\n      console.error(errorMessage, error);\r\n      setError(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-full\">\r\n      <ConversationList\r\n        conversations={conversations}\r\n        currentId={currentConversation?.id || ''}\r\n        onSelect={loadConversation}\r\n      />\r\n      <div className=\"flex flex-col flex-1 relative\">\r\n        {currentConversation && (\r\n          <ModelRoleSwitcher\r\n            models={currentConversation.models}\r\n            onSwitch={handleRoleSwitch}\r\n            disabled={isLoading}\r\n          />\r\n        )}\r\n        <div className=\"flex-1 overflow-auto p-4 space-y-4\">\r\n          {error && (\r\n            <Alert variant=\"destructive\" className=\"mb-4\">\r\n              <AlertTitle>Error</AlertTitle>\r\n              <AlertDescription>\r\n                {error}\r\n                {error.includes('deepseek-r1:14b') && (\r\n                  <div className=\"mt-2\">\r\n                    <p>Run this command to load the DeepSeek model:</p>\r\n                    <pre className=\"bg-gray-800 text-white p-2 mt-1 rounded\">ollama pull deepseek-r1:14b</pre>\r\n                  </div>\r\n                )}\r\n                {error.includes('qwen2.5-coder') && (\r\n                  <div className=\"mt-2\">\r\n                    <p>Run this command to load the Qwen model:</p>\r\n                    <pre className=\"bg-gray-800 text-white p-2 mt-1 rounded\">ollama pull qwen2.5-coder</pre>\r\n                  </div>\r\n                )}\r\n                {error.includes('not running') && (\r\n                  <p className=\"mt-2\">Make sure Ollama is installed and running on your system.</p>\r\n                )}\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n          {messages.map((message) => (\r\n            <div\r\n              key={message.id}\r\n              className={`flex ${\r\n                message.role === 'user' \r\n                  ? 'justify-end' \r\n                  : message.role === 'system' \r\n                    ? 'justify-center' \r\n                    : 'justify-start'\r\n              }`}\r\n            >\r\n              <div\r\n                className={`max-w-[80%] rounded-lg p-3 ${\r\n                  message.role === 'user' \r\n                    ? 'bg-blue-500 text-white' \r\n                    : message.role === 'system'\r\n                      ? 'bg-gray-200 text-gray-600 text-sm'\r\n                      : 'bg-gray-100'\r\n                }`}\r\n              >\r\n                {message.content}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"p-4 border-t\">\r\n          <div className=\"flex gap-2\">\r\n            <Input\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              placeholder={isServerConnected ? \"Type your message...\" : \"Connecting to Ollama server...\"}\r\n              disabled={isLoading || !isServerConnected}\r\n            />\r\n            <Button \r\n              type=\"submit\" \r\n              disabled={isLoading || !isServerConnected}\r\n              title={!isServerConnected ? \"Waiting for Ollama server connection\" : undefined}\r\n            >\r\n              {isLoading ? 'Sending...' : 'Send'}\r\n            </Button>\r\n          </div>\r\n          {!isServerConnected && !error && (\r\n            <Alert className=\"mt-4\">\r\n              <AlertTitle>Connecting...</AlertTitle>\r\n              <AlertDescription>\r\n                Attempting to connect to Ollama server...\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1509, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}